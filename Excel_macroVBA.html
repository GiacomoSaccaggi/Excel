<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

<title>Excel</title>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-147261423-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-147261423-1');
</script>
	
<link rel="stylesheet" media="screen and (min-width:481px)" href="cv.css">

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


</head>

<body>

    
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="https://giacomosaccaggi.github.io">Home</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                  
                    <li>
                        <a href="https://giacomosaccaggi.github.io/Excel/">Excel articles</a>
                    </li>
                    <li>
                        <a href="https://giacomosaccaggi.github.io/all.html">All projects</a>
                    </li>
                    <li>
                        <a href="https://giacomosaccaggi.github.io/contact.html">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('sfondo.png')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="site-heading">
                        <h2>Excel - Visual Basic for Applications (VBA)</h2>
                        <hr class="small">
                        <h5>Uno strumento semplice e per chiunque</h5>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <p>Inconsciamente quando creiamo una macro è come se stessimo programmando in VBA (Visual Basic for Application).</p>
        <h2>Cos'è VBA?</h2>
        <p>Visual Basic for Applications (VBA) è un'implementazione di Visual Basic inserita all'interno di applicazioni Microsoft quali la suite Microsoft Office o Visio, altri programmi contengono un'implementazione parziale di VBA (ad esempio AutoCAD e WordPerfect). 
        <br>Nonostante il suo stretto legame con Visual Basic, VBA non può essere usato per eseguire applicazioni stand-alone, ma è comunque possibile una certa interoperatività fra applicazioni (ad esempio è possibile creare un report in Word a partire da dati di Excel) grazie all'automazione (tecnologia COM, Component Object Model).<br>[Fonte: wikipedia]
        <h2>Modificare una macro con VBA</h2>
        <p>Per introdurre VBA guardiamo la macro fatta nella sezione precedente per togliere i riferimenti da una colonna e cambiargli formato:<br>
        <ul><li>Procediamo aprendo la registrazione di una macro, dantogli un nome e uno shrtcut che reputiamo comodo.</li>
        <li>Ci troviamo già nella cella ad apice, quindi clicchiamo <b>Ctrl + [Maiusc] + [freccia giù]</b> per selezionare l'intera colonna</li>
        <li>La copiamo con <b>Ctrl + c</b></li>
        <li>Poi clicchiamo su <code>Home >Incolla >Incolla speciale >Incolla Valori</code> per togliere i collegamenti</li>
        <li>Cambiamo il formato della colonna in base alle esigenze</li>
        <li>Ed infine clicca sul comando "Interrompi registrazione", per terminate la Macro.
        </li></ul>
        Una volte eseguite queste operazioni cosi come descritte avremo una macro collegata con lo shortcut che gli abbiamo dato.

        <br><br>Per modificare la macro con VBA andiamo su <code>Sviluppo > Visualizza macro</code><br>
        <br><center><img src="img/macrovba1.png" width="70%"><br></center>

        <br><br>Selezioniamo la macro che vogliamo modificare e clicchiamo su modifica<br>
        <br><center><img src="img/macrovba2.png" width="40%"><br></center>
        
        <br><br>Una volta cliccato su modifica si aprirà visual basic con inserito nel modulo1 la macro da noi creata.<br>
        <br><center><img src="img/macrovba3.png" width="70%"><br></center>
<br><br><h3>Codice VBA della macro:</h3>
<br><br><br>
<pre>
Sub Macro1()
'
' Macro1 Macro
' Macro di prova
'
' Scelta rapida da tastiera: CTRL+g
'
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.NumberFormat = "m/d/yyyy"
End Sub
</pre>
        </p>Come si può notare dal codice sopra, ogni movimento fatto corrisponde a delle procedure specifiche; infatti con <code>Range(Selection, Selection.End(xlDown)).Select</code> selezioniamo tutta la colonna; con <code>Selection.Copy</code> copiamo la selezione; con <code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _:=False, Transpose:=False</code> incolliamo per valori; con <code>Application.CutCopyMode = False</code> rimuoviamo l'elemento copiato; ed infine con <code>Selection.NumberFormat = "m/d/yyyy"</code> gli cambiamo il formato in formato data.
        
        </p><br><br>
        <h1>Programmare in VBA</h1>
        <p><b>Da qui in poi si fa sul serio!!!</b> Premetto che non affronteremo a fondo tutti i comandi presenti in VBA perchè credo che, una volta compresi i meccanismi e la logica che sta alla base del linguaggio, il più fa la pratica e affrontare problemi differenti.</p>
        <p>Iniziamo elencando le variabili utilizzabili in questo linguaggio:</p>
        <style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0lax">Tipologia di dati</th>
    <th class="tg-0lax">Dimensione</th>
    <th class="tg-0lax">Intervallo memorizzazione</th>
  </tr>
  <tr>
    <td class="tg-0lax">Byte</td>
    <td class="tg-0lax">1 byte</td>
    <td class="tg-0lax">Da 0 a 255</td>
  </tr>
  <tr>
    <td class="tg-0lax">Boolean</td>
    <td class="tg-0lax">2 byte</td>
    <td class="tg-0lax">True o False</td>
  </tr>
  <tr>
    <td class="tg-0lax">Integer</td>
    <td class="tg-0lax">2 byte</td>
    <td class="tg-0lax">Da -32.768 a 32.767</td>
  </tr>
  <tr>
    <td class="tg-0lax">Long (intero lungo)</td>
    <td class="tg-0lax">4 byte</td>
    <td class="tg-0lax">Da -2.147.483.648 a 2.147.483.647</td>
  </tr>
  <tr>
    <td class="tg-0lax">Single (virgola mobile semplice)</td>
    <td class="tg-0lax">4 byte</td>
    <td class="tg-0lax">Da -3.402823E38 a -1.401298E45 e da 1.401298E45 a 3.402823E38</td>
  </tr>
  <tr>
    <td class="tg-0lax">Double (virgola mobile a doppia precisione)</td>
    <td class="tg-0lax">8 byte</td>
    <td class="tg-0lax">-4.94065645841247E-324 per i valori negativi e 4.94065645841247E-324 per i valori positivi</td>
  </tr>
  <tr>
    <td class="tg-0lax">Currency</td>
    <td class="tg-0lax">8 byte</td>
    <td class="tg-0lax">Da -922.337.203.685.477,5808 a 922.337.203.685.477,5808</td>
  </tr>
  <tr>
    <td class="tg-0lax">Date</td>
    <td class="tg-0lax">8 byte</td>
    <td class="tg-0lax">Dal 1 Gennaio 100 al 31 Dicembre 9999</td>
  </tr>
  <tr>
    <td class="tg-0lax">Object</td>
    <td class="tg-0lax">4 byte</td>
    <td class="tg-0lax">Qualsiasi riferimento a oggetto</td>
  </tr>
  <tr>
    <td class="tg-0lax">String (Testo)</td>
    <td class="tg-0lax">10 byte + lunghezza stringa</td>
    <td class="tg-0lax">Da 0 a, circa, 2 miliardi</td>
  </tr>
  <tr>
    <td class="tg-0lax">Variant</td>
    <td class="tg-0lax">22 byte + lunghezza stringa</td>
    <td class="tg-0lax">Da 0 a circa 2 miliardi</td>
  </tr>
</table>



<p>Prima di poter vedere come dichiarare una variabile occorre definire il concetto di routine. In Visual Basic esistono due tipi di routine:<ul><li>
Routine Sub: svolgono operazioni ma non restituiscono un valore.</li><li>
Routine Function: svolgono operazioni e restituiscono un valore.</li></ul></p>
La visibilità di una variabile, o di una routine, definisce la sua disponibilità all'interno del progetto. Si possono dichiarare variabili e funzioni a tre livelli:<ul><li>
<b>Livello locale: (Dim)</b> vanno dichiarate all'interno della routine e sono disponibili solo all'interno di essa.</li><li>
<b>Livello di modulo: (Private)</b> Vanno dichiarate in testa alla finestra di modulo di codice e sono viste da tutte le routine contenute all'interno del modulo di codice.</li><li>
<b>Livello pubblico: (Public)</b> Vanno dichiarate in testa alla finestra di modulo di codice e sono viste da tutte le routine e da tutti i moduli di codice appartenenti al progetto.</li></ul>
<p>Prima di poter osservare nel concreto la differenta tra queste due routine dobbiamo aprire un nuovo foglio di Excel e andare su <code>Sviluppo > Visual Basic</code> oppure cliccare ALT + F11. Una volta aperto Visual basic ci troveremo in questa situazione:</p>
<br><center><img src="img/macrovba4pre.png" width="70%"><br></center>
<p>Occorre creare un nuovo modulo andando, all'interno di Visual Basic, su <code>Inserisci > Modulo</code>
<br><center><img src="img/macrovba4.png" width="70%"><br></center>

Apriamo il modulo, cliccandoci sopra due volte, e nell'editor di Visual Basic creiamo la nostra prima routine scrivendo il seguente codice:

<br>
<br>
<pre>
' La seguente variabile è visibile nell'intero progetto
Public risultato As String

' La seguente variabile è visibile a livello di modulo
Private testo As String

Sub inviamessaggio(messaggio As String)
    'Questa routine non restituisce un valore ma esegue un'azione
    MsgBox messaggio, vbInformation, "Un messaggio per te:"
End Sub
Function moltiplicazione(numero1 As Integer, numero2 As Integer) As Integer
    ' Questa routine restituisce un valore ed esegue una azione
    moltiplicazione = numero1 * numero2
End Function

Sub la_prima_macro_con_vba()
    testo = "Il risultato della moltiplicazione è: "
    
    ' La seguente variabile è visibile solo all'interno della funzione
    Dim ris As Integer
    
    ris = moltiplicazione(5, 5)
    risultato = testo & CStr(ris)
    inviamessaggio (risultato)
End Sub

</pre>

<br><center><img src="img/macrovba5.png" width="70%"><br></center>
<p>Si può notare come la routine <code>inviamessaggio()</code> esegua un azione (creare un message box) ma non restituisce un valore, mentre al contrario la funzione <code>moltiplicazione()</code> esegue un operazione e restituisce come valore il risultato.</p>
La terza routine esegue la moltiplicazione tra 5 e 5 attraverso la seconda funzione e restituisce il risultato come messaggio utilizzando la prima routine. Per far partire lo svolgimento di questo primo piccolo programma clicchiamo su <code>Esegui > Esegui Sub/UserForm</code> o clicchiamo F5.<br>
 

<br><center><img src="img/macrovba6.png" width="70%"><br></center>
<br>Selezioniamo poi la macro che vogliamo far partire ossia <b>la_prima_macro_con_vba</b> e clicchiamo su Esegui<br>

<br><center><img src="img/macrovba7.png" width="40%"><br></center>
<br>Il risultato finale che ci compare è:

<br><center><img src="img/macrovba8.png" width="40%"><br></center>
<p>Questa macro che abbiamo creato non è particolarmente utile ma spero aiuti a capire il funzionamento di come programmare in VBA.</p>


<br><h4>Richiamare un valore dal foglio di calcolo</h4>
<p>Per poter inserire o poter operare con un valore inserito nel foglio di calcolo ci sono diversi i metodi, i principali metodi sono 2:</p>

<ul><li>
Range: questa funzione permette di di selezionare una cella o più celle consecutive inserendo come parametri interni la colonna espressa in lettere e la righa espressa in numeri (es. "A1")


<br><center><img src="img/richiamare1.png" width="40%"><br></center>
</li><li>
Cells: questa funzione permette di di selezionare una cella o più celle consecutive inserendo come parametri interni la colonna espressa in numeri e la righa espressa in numeri (es. "A1" = posizione [1,1])


<br><center><img src="img/richiamare2.png" width="40%"><br></center>
</li>
</ul>








<br><br>
Come ultimo argomento di questa prima sezione analizziamo gli Array ossia dei vettori contenenti degli elementi.<br>
<b>Array:</b> Un array è un insieme organizzato di elementi omogenei, identificati da uno stesso nome e da uno o più indici.






<pre>

'Metodo 1 : Usare Dim
Dim arr1()	'arrey di dimensione 0

'Metodo 2 : Specificare la dimensione
Dim arr2(5)  'Dimensione di 5 elementi

'Metodo 3 : Utilizzare 'Array' per specificare i parametri
Dim arr3
arr3 = Array("elemento1","elemento2","elemento3")




</pre>

<br>Specificare le differenti tipologie di elementi:<br><br>
<pre>
Dim arr(5)
arr(0) = "1"           'Numero come String
arr(1) = "VBScript"    'String
arr(2) = 100 		       'Numero intero
arr(3) = 2.45 		     'Numero decimale
arr(4) = #16/08/2020#  'Data
arr(5) = #14.15 PM#    'Ora

</pre>


<b>Solitamente a senso inserire all'interno di un array valori con lo stesso formato</b><br>





<br><h1>Aumentiamo la difficoltà: If...Then...</h1>
Quando programmiamo spesso capita di dover instruire il computer a fare una certa operazione se è presente una determinata caratteristica e a farne un'altra quando questa non fosse presente.<br>
In VBA per gestire questo tipo di eccezioni si utilizza il SE (ossia IF):
<pre>

<b>If</b> condizione <b>Then</b>
    'operazioni da eseguire se la condizione è rispettata
    '...
    '...
    '...
    <b>Else</b>
    'operazioni da eseguire se la condizione no è rispettata
    '...
    '...
    '...
<b>End If</b>

</pre>
<br><br>Per definire una condizione si utilizzano tre tipi di operatori:<br>
<ul><li><b>Operatori matematici </b><br><br>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0lax">Operatore</th>
    <th class="tg-0lax">Descrizione</th>
    <th class="tg-0lax">Utilizzo</th>
  </tr>
  <tr>
    <td class="tg-0lax">+</td>
    <td class="tg-0lax">Somma</td>
    <td class="tg-0lax">Risultato = X + Y</td>
  </tr>
  <tr>
    <td class="tg-0lax">-</td>
    <td class="tg-0lax">Sottrazione</td>
    <td class="tg-0lax">Risultato = X - Y</td>
  </tr>
  <tr>
    <td class="tg-0lax">*</td>
    <td class="tg-0lax">Moltiplicazione</td>
    <td class="tg-0lax">Risultato = X * Y</td>
  </tr>
  <tr>
    <td class="tg-0lax">/</td>
    <td class="tg-0lax">Divisione, restituisce un numero a virgola mobile</td>
    <td class="tg-0lax">Risultato = X / Y</td>
  </tr>
  <tr>
    <td class="tg-0lax">\</td>
    <td class="tg-0lax">Divisione, restituisce un numero intero</td>
    <td class="tg-0lax">Risultato = X \ Y</td>
  </tr>
  <tr>
    <td class="tg-0lax">Mod</td>
    <td class="tg-0lax">Divisione, restituisce solo il resto</td>
    <td class="tg-0lax">Risultato = X Mod Y (il resto è un intero)</td>
  </tr>
  <tr>
    <td class="tg-0lax">^</td>
    <td class="tg-0lax">Potenza</td>
    <td class="tg-0lax">Risultato = X ^ Y</td>
  </tr>
</table>
<br><br></li><li><b>Operatori logici </b><br><br>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0lax">Operatore</th>
    <th class="tg-0lax">Descrizione</th>
  </tr>
  <tr>
    <td class="tg-0lax">And</td>
    <td class="tg-0lax">If condizione1 And condizione2 then...si verifica solo se entrambe le condizioni sono vere.</td>
  </tr>
  <tr>
    <td class="tg-0lax">Or</td>
    <td class="tg-0lax">If condizione1 Or condizione2 then... si verifica se almeno una condizione è vera.</td>
  </tr>
  <tr>
    <td class="tg-0lax">Not</td>
    <td class="tg-0lax">If Not condizione then... si verifica se “condizione” è falsa.</td>
  </tr>
</table>

<br><br></li><li><b>Operatori di confronto </b><br><br>

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0lax">Operatore</th>
    <th class="tg-0lax">Descrizione</th>
  </tr>
  <tr>
    <td class="tg-0lax">&lt;</td>
    <td class="tg-0lax">Minore</td>
  </tr>
  <tr>
    <td class="tg-0lax">&lt;=</td>
    <td class="tg-0lax">Minore o Uguale</td>
  </tr>
  <tr>
    <td class="tg-0lax">&gt;</td>
    <td class="tg-0lax">Maggiore</td>
  </tr>
  <tr>
    <td class="tg-0lax">&gt;=</td>
    <td class="tg-0lax">Maggiore o Uguale</td>
  </tr>
  <tr>
    <td class="tg-0lax">&lt;&gt;</td>
    <td class="tg-0lax">Diverso (utilizzabile anche con le stringhe)</td>
  </tr>
</table>
</li></ul>
<br><br>Per comprendere l'utilizzo di questa procedura facciamo un esempio:<br><br>

<b>Si vuole creare un input box nel quale dobbiamo inserire un valore e restituiamo come messaggio un testo differente in base a se il numero è maggiore, uguale o minore di 0:</b><br>
<pre>

Sub esempioIF()

    Dim num As Integer
    num = InputBox("Inserisci un valore ", "Esempio utilizzo If")
    If num &gt; 0 Then
        MsgBox "Il numero è positivo", vbInformation, "Risultato:"
    ElseIf num &lt; 0 Then
        MsgBox "Il numero è negativo", vbInformation, "Risultato:"
    Else
        MsgBox "Il numero è uguale a zero", vbInformation, "Risultato:"
    End If
End Sub

</pre>
<br><br>L'input box:<br>
<br><center><img src="img/macrovba9.png" width="40%"><br></center>

<br><br>I risultati in base al numero inserito:<br>
<br><center><img src="img/macrovba9a.png" width="20%"><img src="img/macrovba9b.png" width="20%"><img src="img/macrovba9c.png" width="20%"><br></center>

<br><h1>Ripetere azioni per più volte:</h1><br>


<p>Ci sono diversi metodi per ripetere azioni pù volte in base a quello che dobbiamo fare. Il primo metodo che guardiamo è il ciclo FOR (TO e EACH) e poi approfondiremo la reiterazione con il Do (Until e While).</p>
<hr>
<h4>For To</h4>



<pre>


<b>For</b> Counter = Start <b>To</b> End [<b>Step</b> Value]
[Azioni da reiterare]
<b>Next</b> [counter]


</pre>


Guardiamo un esempio:<br>Vogliamo aggiungere in diagonale un valore in una matrice 7x7<br>
<pre>

Dim i As Integer

For i = 1 To 7
    Foglio1.Cells(i, i).Value = 100
Next i


</pre>

<br><center><img src="img/for1a.png" width="40%"><img src="img/for1b.png" width="40%"><br></center>




Adesso proviamo a modificare lo step:
<pre>

Dim i As Integer

For i = 1 To 6 Step 2
    Foglio1.Cells(i, i).Value = 100
Next i


</pre>

<br><center><img src="img/for2a.png" width="40%"><img src="img/for2b.png" width="40%"><br></center>

<p>Per mettere delle eccezioni per le quali il ciclo for si deve interrompere si consiglia di utilizzare un <code>IF</code> per defiire l'eccezione e al suo interno <code>Exit For</code></p>
<hr>
<h4>For Each</h4>



<pre>


For Each element In collection
[Azioni da reiterare]
Next [element]


</pre>


Guardiamo un esempio:<br>Vogliamo aggiungere un dei fogli di calcolo con dei nomi contenuti in un array.
<pre>


Dim arr
arr = Array("Contabilità", "Finanza", "Assicurazione")


For Each b In arr
  ActiveWorkbook.Sheets.Add(after:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)).Name = b
Next b



</pre>

<br><center><img src="img/for3a.png" width="40%"><img src="img/for3b.png" width="40%"><br></center>


Guardiamo un altro esempio:<br>Vogliamo sottolineare di rosso i valori contenuti nella prima colonna inferiori a 10. (occorre inserire dei valori nella prima colonna del foglio di calcolo)
<pre>

Dim valori As Range
Dim colonna As Range
Set colonna = Range("A1", Range("A1").End(xlDown))
For Each valori In colonna
    If valori.Value &lt; 10 Then
        valori.Interior.Color = vbRed
    End If
Next valori



</pre>

<br><center><img src="img/for4a.png" width="40%"><img src="img/for4b.png" width="40%"><br></center>

<hr>
<h4>Do Until e Do While</h4><br>
Differenze<br>
<ul><li>While. Esegue l'iterazione finchè la condizione è vera e la termina quando diventa falsa. </li><li>Until. Esegue l'iterazione fino a che la condizione è falsa. Termina l'iterazione quando è vera.</li></ul>

Ci sono due modalità per dichiarare questa reiterazione, dichiarando la condizione di interruzione all'inizio:
<pre>

<b>Do { While | Until }</b> [condizione]
[Azioni da reiterare]
<b>Loop</b>
</pre>
 e dichiarando la condizione di interruzione alla fine:
<pre>
<b>Do</b>
[Azioni da reiterare]
<b>Loop { While | Until }</b> [condizione]
</pre>
<br><b>Per una mia comprensione logica io preferisco sempre mettere la condizione all'inizio e mi trovo più spesso ad utilizzare Until piuttosto che While ma "De gustibus non disputandum".</b><br>
<br>
Guardiamo un esempio:<br>Vogliamo sommare i numeri da 1 a 10 (questo stesso problema può essere affrontato da due punti di vista differenti):<br>
<pre>


Sub prova1()
Dim i As Integer
i = 1
Do Until i &gt; 10
    'continuo a sommare fino a quando trovo
    'un valore maggiore di 10
    Result = Result + i
    i = i + 1
Loop
MsgBox Result
End Sub
<hr>
Sub prova2()
Dim i As Integer
i = 1
Do While i &lt;= 10
    'continuo a sommare fino a quando non trovo
    'un valore minore uguale di 10
    Result = Result + i
    i = i + 1
Loop
MsgBox Result
End Sub


</pre>
<br><center><img src="img/loop1.png" width="60%"><br></center>

<br><center><img src="img/loop2.png" width="20%"><br></center>

<h1>Facciamo un po' di chiarezza! </h1>
<h4>Una sintesi un po' più strutturata</h4>
<p>Una pagina di excel (worksheet) è un oggetto parte di un insieme di pagine (worksheets), contenute nel foglio di lavoro (workbook), ed è composta e contiene oggetti:
<ul>
  <li>
    Application:<br>
    indica la sessione di Excel, quindi tutti i fogli aperti.

  </li><li>
    Workbook<br>
    rappresenta una cartella di lavoro di Excel questo oggetto viene spesso utilizzato per progetti che coinvolgono più fogli di lavoro.

  </li><li>
    Worksheet<br>
    rappresenta la singola pagina excel che a sua volta contiene altri oggetti.

  </li><li>
    Range<br>
    come visto prima rappresenta un intervallo di celle, quindi dalla singola cella, righe o colonne, fino a una matrice di celle. 

  </li><li>
    Chart<br>
    rappresenta un grafico o diagramma.

  </li><li>
    ChartObject<BR>
    è un oggetto che rappresenta anch’esso un grafico, ma incorporato nella pagina (worksheet) ed è membro dell’insieme ChartObjects.
    
  </li><li>
    ListObject<BR>
    rappresenta una tabella Excel presente in una pagina (worksheets) ed è membro dell’insieme ListObjects.

  </li><li>
    PivotTable<br>
    rappresenta una tabella pivot inserita in una pagina (worksheets) ed è membro dell’insieme PivotTables. 
    
  </li><li>
    Selection<br>
    è un oggetto speciale che memorizza o meglio indirizza all’oggetto selezionato con il metodo Select. Questo oggetto personalmente lo trovo molto comodo per creare macro con shortcut che posso utilizzare in diverse situazioni.

  </li>
</ul>
</p>
<p>Gli insiemi di oggetti ci permettono di identificare univocamente i singoli oggetti, ad esempio Workbook può essere inteso come un oggetto nel senso che posso modificare le proprietà del foglio di calcolo ma può anche identificare un insieme di oggetti in quanto all'interno del foglio ci saranno presenti tabelle o altro. 
In questi casi si utilizza il nome al plurale degli oggetti per identicarne la categoria:


<ul>
  <li>
    Workbooks<br> che contiene tutti gli oggetti Workbook (File di excel aperti) aperti in Excel.
  </li><li>
    Worksheets<br> insieme di tutti gli oggetti Worksheet (Fogli di calcolo presenti nel documento) nella cartella di lavoro specificata o attiva.
  </li><li>
    Sheets<br> insieme di tutte le pagine del foglio di lavoro specificato e contiene sia oggetti Worksheet, pagine standard, che ChartObjects. 
  </li><li>
    Charts<br> insieme dei grafici.
  </li><li>
    ChartObjects<br> insieme dei grafici incorporati nella pagina.
  </li><li>
    ListObjects<br> insieme delle tabelle presenti nelle pagine Excel.
  </li><li>
    PivotTables<br> insieme delle tabelle pivot presenti nella pagine.
  </li>




</ul> </p>

<p>Di ogni oggetto posso definire le proprietà o utilizzarne dei metodi. In VBA per definire metodo e proprietà davanti all'oggetto si pone il <code>.</code>. Un esempio di definizione di una proprietà è: <code> Worksheets("Foglio1").Range("A1:B12").Font.Bold</code> imposta il grassetto; Un esempio di definizione di un metodo: <code> Worksheets("Foglio1").Range("A1:B12").Copy</code> copia le celle.</p>
<br><b>Le principali proprietà:</b><br>
 <style type="text/css">
	table.tableizer-table {
		border: 1px solid #CCC; 
	} 
	.tableizer-table td {
		padding: 8px;
		margin: 6px;
		border: 2px solid #CCC;
	}
	.tableizer-table th {
		background-color: #104E8B; 
		color: #FFF;
		font-weight: bold;
	}
</style>
<table class="tableizer-table">
<thead><tr class="tableizer-firstrow"><th></th><th>Nome</th><th>Descrizione</th></tr></thead><tbody>
 <tr><td>1</td><td> Name</td><td>Tutti gli oggetti hanno un nome che può essere modificato o assegnato. Alcuni oggetti ne hanno due, per esempio le pagine (worksheet) hanno un nome formale (che possiamo modificare rinominando il foglio di calcolo) e un nome che corrisponde all'etichetta (che possiamo rinominare <code>ActiveWorkbook.Worksheets ("Foglio1"). Name = 'Nuovonome'</code>).</td></tr>
 <tr><td>2</td><td> Value</td><td>Viene utilizzata per l'associazione di valori nelle celle è utilizzata spesso con gli oggetti range e cells (es. <code>Worksheets(1).Range("A1").Value = 100</code>).</td></tr>
 <tr><td>3</td><td> Visible</td><td>Questa proprietà identifica la visibilità di un oggetto e può assumente un valore booleano: True o False (es. <code>Worksheets(1).Visible = False / True</code>).</td></tr>
 <tr><td>4</td><td> Formula</td><td>Viene utilizzata per l'associazione di formule nelle celle è utilizzata spesso con gli oggetti range e cells (es. <code>Worksheets(1).Range("A1").Formula = "=SE(B1=""; "NA"; B1)"</code>)</td></tr>
 <tr><td>5</td><td> FormulaR1C1</td><td>Viene utilizzata per l'associazione di formule con notazione R1C1 nelle celle è utilizzata spesso con gli oggetti range e cells (es. <code>Worksheets(1).Range("R1C1").Formula = "=SE(R1C2=""; "NA"; R1C2)"</code>) [notazione R1C1= "R+numero_riga+C+numero_colonna"]</td></tr>
 <tr><td>6</td><td> Font</td><td>Questa proprietà definisce il font impiegato.</td></tr>
 <tr><td>7</td><td> Count</td><td>Questa proprietà si utilizza con gli insiemi di oggetti e restituisce il numero di oggetti relativi presenti.</td></tr>
 <tr><td>8</td><td> End</td><td>Questa proprietà di Range e rappresenta la fine della regione di celle in cui è presente la cella selezionata, in una delle quattro direzioni possibili: xlDown / xlUp / xlRight / xlLeft (es. <code>Range("A1").End(xlDown).Select</code>)</td></tr>
 <tr><td>9</td><td> Offset</td><td>Questa proprietà di Range che restituisce una posizione vicina alla cella selezionata, bisogna indicare direzione e coordinate di spostamento (es. <code>Range("A1").Offset(1, 0)</code>).</td></tr>
 <tr><td>10</td><td> Cells</td><td>Questa proprietà restituire una cella inserendo riga e colonna.</td></tr>
 <tr><td>11</td><td> UsedRange</td><td>Questa proprietà di Worksheet che identifica l'area di lavoro della pagina (es. ActiveSheet.UsedRange.Copy).</td></tr>
 <tr><td>12</td><td> DisplayAlerts</td><td>Questa proprietà di Application permette di sospendere gli allarmi automatici del sistema (es. Application.DisplayAlerts = False) attenzione però ad aprire file di cui non si conosce l'origine e sconsiglio di farlo ma in alcuni processi può essere utile.</td></tr>
</tbody></table>
<br><b>I principali metodi:</b><br>
<table class="tableizer-table">
<thead><tr class="tableizer-firstrow"><th></th><th>Nome</th><th>Descrizione</th></tr></thead><tbody>
 <tr><td>1</td><td> Select</td><td>Questo funzione selezione un oggetto.</td></tr>
 <tr><td>2</td><td> Activate</td><td>Questa funziona porta in primo piano un oggetto senza selezionarlo.</td></tr>
 <tr><td>3</td><td> Add</td><td>Questo metodo è utilizzato per creare nuovi oggetti.</td></tr>
 <tr><td>4</td><td> Copy</td><td>Questa funzione copia un certo elemento selezionato in precedenza.</td></tr>
 <tr><td>5</td><td> Paste</td><td>Questa funzione incolla un certo elemento copiato in precedenza.</td></tr>
 <tr><td>6</td><td> Delete</td><td>Questa funzione serve per eliminare un determinato oggetto.</td></tr>
 <tr><td>7</td><td> Close</td><td>Questo metodo è utilizzato per chiudere un oggetto (workbook, userform, ecc.).</td></tr>
 <tr><td>8</td><td> Save</td><td>Questa funzione permette di salvare il file.</td></tr>
 <tr><td>9</td><td> PrintOut</td><td>Questa funzione consente di stampare l'oggetto specificato.</td></tr>
 <tr><td>10</td><td> ClearContents</td><td>Questo metodo cancella il contenuto delle celle selezionate (formule e valori).</td></tr>
 <tr><td>11</td><td> Autofill</td><td>Questa funzione dell'oggetto Range riempie in automatico le celle dell'intervallo dichiarato a partire dal contenuto di alcune celle (uguale allo strumento che possiamo richiamare con un doppio clic sul quadrato in basso a destra della selezione o trascinando la selezione in una direzione).</td></tr>
</tbody></table>



        <br><br><br>
  </div>
   <!-- Footer -->
    <footer>
       <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://twitter.com/SaccaggiGiacomo">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.linkedin.com/in/giacomo-saccaggi-782439163/">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/GiacomoSaccaggi/">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; GiacomoSaccaggi</p>
                </div>
            </div>
        </div>
    </footer>
    </body>

</html>
